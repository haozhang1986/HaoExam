\# 产品需求文档 (PRD)  
\*\*项目名称：\*\* A-Level & AP 数学真题分级图库与智能组卷系统  
\*\*版本号：\*\* v1.1  
\*\*日期：\*\* 2025-12-03  
\*\*项目负责人：\*\* \[张昊\]  
\*\*开发方：\*\* Antigravity

\---

\#\# 1\. 项目概述 (Project Overview)

\#\#\# 1.1 背景  
本项目旨在开发一个基于 Web 的数学真题管理系统。核心目标是将海量的 A-Level 和 AP 数学真题进行\*\*数字化、标签化管理\*\*，并提供高效的\*\*检索\*\*与\*\*自定义组卷 (PDF生成)\*\* 功能。

\#\#\# 1.2 核心策略 (Core Strategy)  
\* \*\*纯图片流 (Image-Centric):\*\* 摒弃繁琐的 LaTeX 录入，题目与答案均以\*\*图片\*\*形式存储。  
\* \*\*标签驱动 (Tag-Driven):\*\* 通过多维度标签（知识点、难度、年份）实现精准检索。  
\* \*\*所见即所得 (WYSIWYG):\*\* 组卷结果直接生成可打印的 A4 PDF。

\---

\#\# 2\. 用户角色 (User Roles)

\* \*\*超级管理员 (Admin/Teacher):\*\*  
    \* 拥有最高权限。  
    \* 负责上传题目、打标签、维护题库。  
    \* 可创建、编辑、导出试卷。  
\* \*\*学生用户 (Student):\*\*  
    \* 浏览题库，按知识点筛选题目进行练习。  
    \* 查看答案（点击展开）。  
    \* 可以将题目加入“错题本”或“练习篮”并下载（权限由管理员配置）。

\---

\#\# 3\. 功能需求详情 (Functional Requirements)

\#\#\# 3.1 数据库与分类体系 (Taxonomy & Database)  
系统需支持以下层级的标签结构，且管理员可在后台灵活增删：  
1\.  \*\*课程体系 (Curriculum):\*\* A-Level, AP.  
2\.  \*\*科目 (Subject):\*\* e.g., Pure Math 1, Statistics, Calculus BC.  
3\.  \*\*知识点 (Topic Tree):\*\* 支持至少两级（Topic \-\> Sub-topic）。  
4\.  \*\*元数据 (Metadata):\*\*  
    \* 年份 (Year)  
    \* 考季 (Season: May/June, Oct/Nov)  
    \* 卷号 (Paper/Variant)  
    \* 题号 (Question No.)  
    \* \*\*难度 (Difficulty Level):\*\* Easy (基础), Medium (中等), Hard (困难)

\#\#\# 3.2 后台录入系统 (CMS \- High Priority)  
\*这是提高生产力的核心模块，要求极高的操作效率。\*  
\* \*\*剪贴板上传:\*\* 支持直接 Ctrl+V 粘贴截图。  
\* \*\*双图录入界面:\*\* 同一窗口包含两个上传区域：左侧上传【题目图】，右侧上传【答案图】（包含评分标准）。  
\* \*\*标签记忆功能:\*\* 系统应自动“记住”上一次提交的非特异性标签（如年份、科目、Paper），只需修改题号和知识点即可进行下一题录入。

\#\#\# 3.3 题库浏览与搜索 (Frontend Browser)  
\* \*\*侧边栏过滤器:\*\* 允许用户通过复选框组合筛选（例如：A-Level \+ Integration \+ Hard）。  
\* \*\*瀑布流展示:\*\* 题目以卡片形式展示预览图。  
\* \*\*图片交互:\*\* 点击题目图片可查看高清大图 (Lightbox)。  
\* \*\*查看答案:\*\* 每题下方设有 "Show Answer" 按钮，默认折叠，点击后展开答案图片。

\#\#\# 3.4 智能组卷车 (Worksheet Builder)  
\* \*\*加入试卷:\*\* 类似电商“购物车”逻辑，用户在浏览时点击“+”将题目加入试卷篮。  
\* \*\*排序调整:\*\* 在试卷篮中，支持拖拽调整题目顺序。  
\* \*\*PDF 导出引擎 (核心技术难点):\*\*  
    \* \*\*布局:\*\* 自动将选中的图片拼接在 A4 画布上。  
    \* \*\*宽度自适应:\*\* 所有上传的图片在 PDF 中必须强制统一宽度（保持宽高比），确保排版整齐。  
    \* \*\*智能防切题 (Smart Page Break):\*\* 算法必须检测当前页面剩余高度。如果 \`剩余高度 \< 图片高度\`，则强制换页，\*\*严禁将一道题目的图片切割在两页上\*\*。  
    \* \*\*两种导出模式:\*\*  
        1\.  \*\*学生版:\*\* 仅包含题目图，每题之间预留空白（可设置留白高度）供书写。  
        2\.  \*\*教师版:\*\* 题目图下方直接紧跟答案图。

\---

\#\# 4\. 非功能性需求 (Non-Functional Requirements)

\#\#\# 4.1 性能要求  
\* \*\*图片压缩:\*\* 系统需在上传时自动压缩图片（建议转换为 WebP 格式），在保证文字清晰的前提下最小化文件体积，确保加载速度。  
\* \*\*响应速度:\*\* 筛选结果应在 1秒内 呈现 (AJAX)。

\#\#\# 4.2 兼容性  
\* 管理端重点优化 PC/Mac 桌面端体验（Chrome/Edge）。  
\* 学生端需适配 Mobile/Tablet 浏览。

\---

\#\# 5\. 推荐技术栈 (Suggested Tech Stack)

\*建议 Antigravity 团队参考以下技术方案：\*

\* \*\*后端:\*\* Python (Django/Flask) 或 Node.js。Python 在图像处理库上更有优势。  
\* \*\*数据库:\*\* PostgreSQL (处理复杂标签关系的最佳选择)。  
\* \*\*图像处理:\*\* Pillow (Python) 或 Sharp (Node.js) 用于尺寸标准化和压缩。  
\* \*\*PDF 引擎:\*\* ReportLab (Python) 或 Puppeteer (Headless Chrome)。\*\*必须能够精确控制分页逻辑。\*\*  
\* \*\*存储:\*\* AWS S3 或同等级别的对象存储服务。

\---

\#\# 6\. 验收标准 (Acceptance Criteria)

1\.  \*\*录入测试:\*\* 管理员能在 30 秒内完成一道题（含题目+答案+标签）的录入。  
2\.  \*\*PDF 测试:\*\* 导出的 PDF 试卷中，没有图片被横向切割，排版整齐，文字清晰可读。  
3\.  \*\*筛选测试:\*\* 组合筛选功能准确无误，无遗漏。

\---

\#\#\# 给 Antigravity 的特别备注 (Note to Developers):  
\> 本项目不需要 LaTeX 公式渲染引擎。所有内容均为静态图片。请重点关注 \*\*图片的高效存储/分发\*\* 以及 \*\*PDF 生成时的智能分页算法\*\*。  
