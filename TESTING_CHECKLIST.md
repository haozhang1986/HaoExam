# HaoExam 网站完整测试方案

> **用途**：每次提交 GitHub 之前执行此测试清单，确保所有功能正常工作。
> **预计时间**：20-25 分钟

---

## 🔧 测试前准备

- [ ] 确保后端服务器正在运行：`cd backend && uvicorn app.main:app --reload`
- [ ] 在浏览器中打开 `http://127.0.0.1:8000`
- [ ] 硬刷新页面 (`Cmd+Shift+R` / `Ctrl+Shift+R`) 清除缓存

---

## 1️⃣ 页面加载测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 首页加载 | 页面正常显示，无控制台错误 | |
| 左侧筛选器加载 | 所有下拉菜单正常显示 | |
| 题目卡片加载 | Gallery 区域显示题目卡片 | |

---

## 2️⃣ 用户认证测试

### 2.1 三种账户类型测试

| 账户类型 | 用户名/密码 | 预期功能权限 |
|----------|-------------|--------------|
| Admin | `admin` / `admin123` | 全部功能：筛选、上传、管理题目、管理标签 |
| Teacher | `teacher` / `teacher123` | 筛选、上传 (**无管理权限**) |
| Student | `student` / `student123` | 仅筛选、查看、生成PDF |

### 2.2 登录功能测试
| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 点击 "Login / Sign Up" | 弹出登录模态框 | |
| 使用 `admin` / `admin123` 登录 | 登录成功，显示 "admin"，**Management 可用** | |
| 登出后用 `teacher` / `teacher123` 登录 | **Upload 可用，Management 不可用或受限** | |
| 登出后用 `student` / `student123` 登录 | **仅 Question Bank 和 PDF 功能可用** | |
| 使用错误密码登录 | 显示错误提示 | |
| 点击 "Sign Out" | 成功登出，显示 "Guest" | |
| 点击 "Continue as Guest" | 关闭登录框，以游客身份浏览 | |

---

## 3️⃣ 题目筛选测试

### 3.1 筛选器类型

| 筛选器 | 类型 | 动态变化规则 |
|--------|------|-------------|
| Curriculum | **单选** | 无 |
| Subject | **单选** | 随 Curriculum 变化 |
| Topic | **多选** | 随 Curriculum + Subject 变化 |
| Sub-topic | **多选** | 随 Topic 变化 |
| Year | **多选** | 不动态变化 |
| Month/Season | **多选** | 随 Curriculum 变化 |
| Difficulty | **多选** | 不动态变化 |

### 3.2 动态层级关系测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 选择 Curriculum (如 A-Level) | Subject 选项更新为该课程的科目 | |
| 选择 Subject (如 Math) | Topic 选项更新为该科目的主题 | |
| 选择 Topic | Sub-topic 选项更新为该主题的子主题 | |
| 切换 Curriculum | Subject/Topic/Sub-topic 重置，Month 选项更新 | |
| Year 和 Difficulty | **不随其他筛选器变化** | |

### 3.3 多选筛选器测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| Topic 下拉显示复选框 | 可选择多个 Topic | |
| 选择多个 Topic | 题目列表显示匹配任意选中 Topic 的题目 | |
| Sub-topic 允许多选 | 可选择多个 Sub-topic | |
| 点击 "Reset Filters" | 所有筛选器重置为 "All" | |

### 3.4 ID 搜索与筛选器互斥测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 在搜索框输入题目 ID | 只显示该 ID 的题目，**侧边栏筛选器自动清空** | |
| 点击 × 清除搜索 | 搜索框清空，显示所有题目 | |
| **在筛选器中选择任意选项** | **ID 搜索框自动清空** | |
| 搜索和筛选互不干扰 | 同时只能使用 ID 搜索或筛选器，不能同时使用 | |

---

## 4️⃣ 题目卡片交互测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 点击问题图片 | 图片放大显示 | |
| 点击 "View Answer" | 弹出答案图片模态框 | |
| 关闭答案模态框 | 正常关闭 | |
| 点击 "+" 添加到篮子 | 篮子计数增加，按钮变为 "−" | |
| 点击 "−" 从篮子移除 | 篮子计数减少，按钮变回 "+" | |
| 卡片显示题目 ID | 每张卡片显示唯一的 ID 标签 | |

---

## 5️⃣ PDF 生成与下载测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 添加 1-3 个题目到篮子 | "Generate PDF" 按钮启用 | |
| 勾选 "Include Answers" | 复选框被选中 | |
| 点击 "Generate PDF (Safe)" | 按钮显示 "Generating..."，然后下载开始 | |
| **检查下载的文件名** | **格式：`YYYY-MM-DD_HaoExam_Worksheet.pdf`** | |
| 检查文件是否为有效 PDF | 能正常打开并显示题目 | |
| 取消勾选 "Include Answers" 后生成 | PDF 不包含答案 | |
| 勾选 "Include Answers" 后生成 | PDF 包含答案 | |
| **PDF 中显示题目 ID** | 每道题的标签包含 `[ID: xxx]` | |

---

## 6️⃣ 上传新题目测试

> ⚠️ **需要登录为 teacher 或 admin**

### 6.1 基本上传功能

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 点击 "Upload New" 导航 | 显示上传页面 | |
| 上传问题图片（拖拽或点击） | 图片预览显示 | |
| 上传答案图片 | 图片预览显示 | |
| 粘贴图片 (Ctrl+V) | 图片粘贴成功 | |
| 点击 × 清除上传的图片 | 图片清除，恢复占位符 | |

### 6.2 标签动态层级测试（上传表单）

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 选择 Curriculum | Subject 选项根据课程更新 | |
| 选择 Subject | Topic 选项根据科目更新 | |
| 选择 Topic | Sub-topic 选项根据主题更新 | |
| Month 随 Curriculum 变化 | 选择不同课程后 Month 选项更新 | |

### 6.3 新建标签功能

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| Curriculum 下拉有 "+ Create New" 选项 | 选择后显示输入框 | |
| Subject 下拉有 "+ Create New" 选项 | 选择后显示输入框 | |
| Topic 下拉有 "+ Create New" 选项 | 选择后显示输入框 | |
| Sub-topic 下拉有 "+ Create New" 选项 | 选择后显示输入框 | |
| 输入新标签名并保存题目 | 新标签被创建并关联到题目 | |

### 6.4 保存验证

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 填写所有必填字段并保存 | 显示成功提示，题目添加到数据库 | |
| 在 Gallery 中验证新题目 | 新题目显示在列表中，有唯一 ID | |

---

## 7️⃣ 题目管理测试

> ⚠️ **仅限 admin 账户**（teacher 无管理权限）

### 7.1 权限验证

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 以 admin 登录 | Management 页面完全可用 | |
| 以 teacher 登录 | **Management 功能受限或不可见** | |
| 以 student 登录 | **无 Management 入口** | |

### 7.2 Questions 标签页（admin）

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 点击 "Management" 导航 | 显示管理页面，默认 Questions 标签 | |
| ID 搜索在管理页面有效 | 输入 ID 后只显示该题目 | |
| 点击 "Edit" 按钮 | 弹出编辑模态框 | |
| **编辑时标签有 "+ Create New" 选项** | 可以新建之前没有的标签 | |
| 修改题目信息并保存 | 保存成功，列表更新 | |
| 点击 "Delete" 按钮 | 弹出确认对话框 | |
| 确认删除 | 题目从列表中移除 | |
| 取消删除 | 题目保留 | |

### 7.3 Tags 标签页（admin）

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 切换到 "Tags" 标签 | 显示标签列表 | |
| 点击 "Edit" 修改标签 | 弹出编辑框，保存成功 | |
| 点击 "Delete" 删除标签 | 标签被删除 | |

---

## 8️⃣ 响应式设计测试

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 调整浏览器窗口大小 | 布局自适应调整 | |
| 移动端视图（<768px） | 侧边栏折叠，显示汉堡菜单 | |
| 点击汉堡菜单 | 侧边栏滑出 | |
| 点击遮罩层关闭侧边栏 | 侧边栏收回 | |

---

## 9️⃣ 控制台错误检查

| 测试项 | 预期结果 | ✓/✗ |
|--------|----------|-----|
| 打开浏览器开发者工具 (F12) | |
| 检查 Console 标签 | **无红色错误** | |
| 检查 Network 标签 | 所有 API 请求返回 200/201 | |

---

## 🏁 测试总结

| 分类 | 通过项数 | 总项数 | 状态 |
|------|----------|--------|------|
| 页面加载 | | 3 | |
| 用户认证 | | 7 | |
| 筛选器动态 | | 5 | |
| 多选筛选器 | | 4 | |
| ID搜索互斥 | | 4 | |
| 卡片交互 | | 6 | |
| PDF 生成 | | 8 | |
| 上传基本 | | 5 | |
| 上传动态标签 | | 4 | |
| 新建标签 | | 5 | |
| 权限验证 | | 3 | |
| 题目管理 | | 8 | |
| 标签管理 | | 3 | |
| 响应式 | | 4 | |
| 控制台 | | 2 | |
| **总计** | | **71** | |

---

## ✅ 提交前确认

- [ ] 所有测试项通过
- [ ] 三种账户权限正确
- [ ] 筛选器动态层级正常
- [ ] ID 搜索与筛选器互斥
- [ ] PDF 下载文件名正确
- [ ] 新建标签功能可用
- [ ] 无控制台错误

**准备好提交 GitHub！** 🚀
